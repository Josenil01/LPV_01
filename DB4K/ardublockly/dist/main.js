!function(e){var t={};function n(o){if(t[o])return t[o].exports;var l=t[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(o,l,function(t){return e[t]}.bind(null,l));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);n(1)},function(e,t,n){"use strict";
/**
 * @license Licensed under the Apache License, Version 2.0 (the "License"):
 *          http://www.apache.org/licenses/LICENSE-2.0
 *
 * @fileoverview General javaScript for Arduino app with material design.
 */var o=o||{};o.init=function(){o.initLanguage(),o.injectBlockly(document.getElementById("content_blocks"),o.TOOLBOX_XML,"../blockly/"),o.importExtraBlocks(),o.designJsInit(),o.initialiseIdeButtons(),o.bindDesignEventListeners(),o.bindActionFunctions(),o.bindBlocklyEventListeners(),"localhost"!=document.location.hostname&&(o.openNotConnectedModal(),console.log("Offline app modal opened as non localhost host name found: "+document.location.hostname))},o.bindActionFunctions=function(){o.bindClick_("button_new",o.newSketch),o.bindClick_("button_load",o.loadUserXmlFile),o.bindClick_("button_save",o.saveXmlFile),o.bindClick_("button_delete",o.discardAllBlocks),o.bindClick_("menu_new",(function(){o.newSketch(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_save_codigo",(function(){o.saveCodeFileAs(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_abrir_ide",(function(){o.ideSendOpenSideNav(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_reload",(function(){o.reloadPage(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_load",(function(){o.loadUserXmlFile(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_save",(function(){o.saveXmlFile(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_delete",(function(){o.discardAllBlocks(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_settings",(function(){o.openSettings(),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_example_1",(function(){o.loadServerXmlFile("../examples/piscar_led_vermelho.xml"),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_example_2",(function(){o.loadServerXmlFile("../examples/mover_servo_motor.xml"),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_example_3",(function(){o.loadServerXmlFile("../examples/girar_motor_DC.xml"),$(".button-collapse").sideNav("hide")})),o.bindClick_("menu_example_4",(function(){o.loadServerXmlFile("../examples/escrever_no_LCD.xml"),$(".button-collapse").sideNav("hide")})),o.bindClick_("button_ide_large",(function(){o.ideButtonLargeAction()})),o.bindClick_("button_ide_middle",(function(){o.ideButtonMiddleAction()})),o.bindClick_("button_ide_left",(function(){o.ideButtonLeftAction()})),o.bindClick_("button_load_xml",o.XmlTextareaToBlocks),o.bindClick_("button_toggle_toolbox",o.toogleToolbox),o.bindClick_("button_stop",(function(){o.ideSendUploadEmptyLoop()}));var e=function(e,t,n){var o=document.getElementById(e);!1===o.readOnly&&(o.onkeypress=function(e){if(e||(e=window.event),"13"==(e.keyCode||e.which))return t(o.value,(function(e){n(ArdublocklyServer.jsonToHtmlTextInput(e))})),!1},o.onblur=function(){t(o.value,(function(e){n(ArdublocklyServer.jsonToHtmlTextInput(e))}))})};e("settings_compiler_location",ArdublocklyServer.setCompilerLocation,o.setCompilerLocationHtml),e("settings_sketch_location",ArdublocklyServer.setSketchLocationHtml,o.setSketchLocationHtml)},o.ideSendUpload=function(){o.ideButtonLargeAction!==o.ideSendUpload&&(o.showExtraIdeButtons(!1),o.setIdeSettings(null,"upload")),o.shortMessage("Carregando do Programa na Placa..."),o.resetIdeOutputContent(),o.sendCode()},o.ideSendUploadEmptyLoop=function(){o.setIdeSettings(null,"upload"),o.shortMessage(o.getLocalStr("Parando Execução do Programa na Placa...")),o.resetIdeOutputContent(),o.buttonStopSpinner(!0),o.largeIdeButtonDesable(!0);ArdublocklyServer.sendSketchToServer("void setup(){}void loop(){}",(function(e){if(o.buttonStopSpinner(!1),o.largeIdeButtonDesable(!1),null===e)return o.openNotConnectedModal();var t=ArdublocklyServer.jsonToIdeModal(e);o.arduinoIdeOutput(t)}))},o.ideSendVerify=function(){o.ideButtonLargeAction!==o.ideSendVerify&&(o.showExtraIdeButtons(!1),o.setIdeSettings(null,"verify")),o.shortMessage(o.getLocalStr("verifyingSketch")),o.resetIdeOutputContent(),o.sendCode()},o.ideSendOpen=function(){o.ideButtonLargeAction!==o.ideSendOpen&&(o.showExtraIdeButtons(!1),o.setIdeSettings(null,"open")),o.shortMessage("Abrindo o Programa na IDE Arduino..."),o.resetIdeOutputContent(),o.sendCode()},o.ideButtonLargeAction=o.ideSendUpload,o.ideButtonMiddleAction=o.ideSendVerify,o.ideButtonLeftAction=o.ideSendOpen,o.initialiseIdeButtons=function(){document.getElementById("button_ide_left").title=o.getLocalStr("openSketch"),document.getElementById("button_ide_middle").title=o.getLocalStr("verifySketch"),document.getElementById("button_ide_large").title=o.getLocalStr("uploadSketch"),ArdublocklyServer.requestIdeOptions((function(e){null!=e&&o.changeIdeButtons(e.selected)}))},o.changeIdeButtons=function(e){var t=document.getElementById("button_ide_large"),n=document.getElementById("button_ide_middle"),l=document.getElementById("button_ide_left"),i=o.getLocalStr("openSketch"),r=o.getLocalStr("verifySketch"),d=o.getLocalStr("uploadSketch");"upload"===e?(o.changeIdeButtonsDesign(e),o.ideButtonLeftAction=o.ideSendOpen,o.ideButtonMiddleAction=o.ideSendVerify,o.ideButtonLargeAction=o.ideSendUpload,l.title=i,n.title=r,t.title=d):"verify"===e?(o.changeIdeButtonsDesign(e),o.ideButtonLeftAction=o.ideSendOpen,o.ideButtonMiddleAction=o.ideSendUpload,o.ideButtonLargeAction=o.ideSendVerify,l.title=i,n.title=d,t.title=r):"open"===e&&(o.changeIdeButtonsDesign(e),o.ideButtonLeftAction=o.ideSendVerify,o.ideButtonMiddleAction=o.ideSendUpload,o.ideButtonLargeAction=o.ideSendOpen,l.title=r,n.title=d,t.title=i)},o.loadServerXmlFile=function(e){var t=function(){o.loadXmlBlockFile(e,(function(e){e?o.renderContent():o.alertMessage("Arquivo Inválido",'O Arquivo carregado não pode ser "traduzido" em Blocos. Esse provavalmente não é um arquivo XML do DB4K',!1)}),(function(){o.openNotConnectedModal()}))};o.isWorkspaceEmpty()?t():o.alertMessage("Carregar novos Blocos?","Carregar um novo arquivo fará com que os blocos presentes na área de trabalho sejam repostos.\nVocê tem certeza de que deseja continuar?",!0,t)},o.loadUserXmlFile=function(){var e=document.getElementById("select_file");if(null===e){var t=document.createElement("INPUT");t.type="file",t.id="select_file";var n=document.createElement("DIV");n.id="select_file_wrapper",n.style.display="none",n.appendChild(t),document.body.appendChild(n),(e=document.getElementById("select_file")).addEventListener("change",(function(e){var t=e.target.files[0],n=t.name,l=n.lastIndexOf(".");-1!==l&&(n=n.substr(0,l));var i=new FileReader;i.onload=function(){o.replaceBlocksfromXml(i.result)?(o.renderContent(),o.sketchNameSet(n)):o.alertMessage("Arquivo Inválido",'O Arquivo carregado não pode ser "traduzido" em Blocos. Esse provavalmente não é um arquivo XML do DB4K',!1)},i.readAsText(t)}),!1)}e.click()},o.saveXmlFile=function(){o.saveTextFileAs(document.getElementById("sketch_name").value+".xml",o.generateXml())},o.saveSketchFile=function(){o.saveTextFileAs(document.getElementById("sketch_name").value+".ino",o.generateArduino())},o.saveTextFileAs=function(e,t){var n=new Blob([t],{type:"text/plain;charset=utf-8"});saveAs(n,e)},o.openSettings=function(){ArdublocklyServer.requestCompilerLocation((function(e){o.setCompilerLocationHtml(ArdublocklyServer.jsonToHtmlTextInput(e))})),ArdublocklyServer.requestSketchLocation((function(e){o.setSketchLocationHtml(ArdublocklyServer.jsonToHtmlTextInput(e))})),ArdublocklyServer.requestArduinoBoards((function(e){o.setArduinoBoardsHtml(ArdublocklyServer.jsonToHtmlDropdown(e))})),ArdublocklyServer.requestSerialPorts((function(e){o.setSerialPortsHtml(ArdublocklyServer.jsonToHtmlDropdown(e))})),ArdublocklyServer.requestIdeOptions((function(e){o.setIdeHtml(ArdublocklyServer.jsonToHtmlDropdown(e))})),o.openSettingsModal()},o.setCompilerLocationHtml=function(e){if(null===e)return o.openNotConnectedModal();var t=document.getElementById("settings_compiler_location");null!=t&&(t.value=e.value||t.value||"Please enter the location of the Arduino IDE executable",t.style.cssText=e.style.cssText)},o.setSketchLocationHtml=function(e){if(null===e)return o.openNotConnectedModal();var t=document.getElementById("settings_sketch_location");null!=t&&(t.value=e.value||t.value||"Please enter a folder to store the Arduino Sketch",t.style.cssText=e.style.cssText)},o.setArduinoBoardsHtml=function(e){if(null===e)return o.openNotConnectedModal();var t=document.getElementById("board");null!==t&&($("select").material_select("destroy"),e.name="settings_board",e.id="board",e.onchange=o.setBoard,t.parentNode.replaceChild(e,t),$("select").material_select())},o.setBoard=function(){var e=document.getElementById("board"),t=e.options[e.selectedIndex].value;ArdublocklyServer.setArduinoBoard(t,(function(e){var t=ArdublocklyServer.jsonToHtmlDropdown(e);o.setArduinoBoardsHtml(t)})),o.changeBlocklyArduinoBoard(t.toLowerCase().replace(/ /g,"_"))},o.setSerialPortsHtml=function(e){if(null===e)return o.openNotConnectedModal();var t=document.getElementById("serial_port");null!==t&&($("select").material_select("destroy"),e.name="settings_serial",e.id="serial_port",e.onchange=o.setSerial,t.parentNode.replaceChild(e,t),$("select").material_select())},o.setSerial=function(){var e=document.getElementById("serial_port"),t=e.options[e.selectedIndex].value;ArdublocklyServer.setSerialPort(t,(function(e){var t=ArdublocklyServer.jsonToHtmlDropdown(e);o.setSerialPortsHtml(t)}))},o.setIdeHtml=function(e){if(null===e)return o.openNotConnectedModal();var t=document.getElementById("ide_settings");null!==t&&($("select").material_select("destroy"),e.name="settings_ide",e.id="ide_settings",e.onchange=o.setIdeSettings,t.parentNode.replaceChild(e,t),$("select").material_select())},o.setIdeSettings=function(e,t){if(void 0!==t)var n=t;else{var l=document.getElementById("ide_settings");n=l.options[l.selectedIndex].value}o.changeIdeButtons(n),ArdublocklyServer.setIdeOptions(n,(function(e){o.setIdeHtml(ArdublocklyServer.jsonToHtmlDropdown(e))}))},o.sendCode=function(){o.largeIdeButtonSpinner(!0),o.ideStopButtonDesable(!0);ArdublocklyServer.sendSketchToServer(o.generateArduino(),(function(e){if(o.largeIdeButtonSpinner(!1),o.ideStopButtonDesable(!1),null===e)return o.openNotConnectedModal();var t=ArdublocklyServer.jsonToIdeModal(e);o.arduinoIdeOutput(t)}))},o.XmlTextareaToBlocks=function(){o.replaceBlocksfromXml(document.getElementById("content_xml").value)?o.renderContent():o.alertMessage(o.getLocalStr("invalidXmlTitle"),o.getLocalStr("invalidXmlBody"),!1)},o.PREV_ARDUINO_CODE_="void setup() {\n\n}\n\n\nvoid loop() {\n\n}",o.renderContent=function(){var e=o.generateArduino();if(e!==o.PREV_ARDUINO_CODE_){for(var t=JsDiff.diffWords(o.PREV_ARDUINO_CODE_,e),n=[],l=0;l<t.length;l++)if(!t[l].removed){var i=t[l].value.replace(/</g,"&lt;").replace(/>/g,"&gt;");t[l].added?n.push('<span class="code_highlight_new">'+i+"</span>"):n.push(i)}document.getElementById("content_arduino").innerHTML=prettyPrintOne(n.join(""),"cpp",!1),o.PREV_ARDUINO_CODE_=e}document.getElementById("content_xml").value=o.generateXml()},o.TOOLBAR_SHOWING_=!0,o.toogleToolbox=function(){o.TOOLBAR_SHOWING_?(o.blocklyCloseToolbox(),o.displayToolbox(!1)):o.displayToolbox(!0),o.TOOLBAR_SHOWING_=!o.TOOLBAR_SHOWING_},o.isToolboxVisible=function(){return o.TOOLBAR_SHOWING_},o.importExtraBlocks=function(){ArdublocklyServer.getJson("../blocks/blocks_data.json",(function(e){if(null===e)return o.openNotConnectedModal();if(void 0!==e.categories){var t=document.getElementsByTagName("head")[0];for(var n in e.categories){var l=document.createElement("script");l.src="../blocks/"+n+"/blocks.js",t.appendChild(l);var i=document.createElement("script");i.src="../blocks/"+n+"/msg/messages.js",t.appendChild(i);var r=document.createElement("script");r.src="../blocks/"+n+"/generator_arduino.js",t.appendChild(r);var d=e.categories[n].extensions;if(d)for(var a=0;a<d.length;a++){var c=document.createElement("script");c.src="../blocks/"+n+"/extensions.js",t.appendChild(c),setTimeout((function(e,t){for(var n=t.split("."),o=window,l=!1,i=0;i<n.length;i++)if(void 0===(o=o[n[i]])){l=!0;break}if("function"!=typeof o&&(l=!0),l)throw"Blocks "+e.categoryName+' extension "'+t+'" is not a valid function.';o()}),800,e.categories[n],d[a])}}}}))},o.openExtraCategoriesSelect=function(){ArdublocklyServer.getJson("../blocks/blocks_data.json",(function(e){if(null===e)return o.openNotConnectedModal();var t=document.createElement("div");if(void 0!==e.categories)for(var n in e.categories)!function(e){t.appendChild(o.createExtraBlocksCatHtml(e.categoryName,e.description,(function(t){if(t){var n=(new DOMParser).parseFromString(e.toolbox.join(""),"text/xml").firstChild;o.addToolboxCategory(e.toolboxName,n)}else o.removeToolboxCategory(e.toolboxName)})))}(e.categories[n]);o.openAdditionalBlocksModal(t)}))},o.functionNotImplemented=function(){o.shortMessage("Function not yet implemented")},o.alertMessage=function(e,t,n,l){o.materialAlert(e,t,n,l)},o.shortMessage=function(e){o.MaterialToast(e)},o.bindClick_=function(e,t){"string"==typeof e&&(e=document.getElementById(e));var n=function(e){e.stopPropagation(),e.preventDefault(),t()};e.addEventListener("ontouchend",n),e.addEventListener("click",n)},o.newSketch=function(){var e=o.workspace.getAllBlocks().length;e<=1?(o.workspace.clear(),o.renderContent(),document.getElementById("sketch_name").value="Nome_do_Programa",document.getElementById("sketch_name").size=16):e>1&&o.alertMessage("Apagar todos os Blocos?","Existem "+e+" blocos na área de trabalho. Você tem certeza que deseja apagá-los e começar um novo programa?",!0,(function(){o.workspace.clear(),o.renderContent(),document.getElementById("sketch_name").value="Nome_do_Programa",document.getElementById("sketch_name").size=16}))},o.saveCodeFileAs=function(){var e=document.getElementById("sketch_name").value,t=Blockly.Arduino.workspaceToCode(o.workspace),n=new Blob([t],{type:"text/plain;charset=utf-8"});saveAs(n,e+".ino")},o.reloadPage=function(){var e=o.workspace.getAllBlocks().length;0==e?document.location.reload(!0):e>=1&&o.alertMessage("Recarregar a página?","Existem "+e+" blocos na área de trabalho.Se você recarregar a página todos os blocos serão apagados. Deseja continuar?",!0,(function(){document.location.reload(!0)}))},o.ideSendOpenSideNav=function(){o.changeIdeButtons("open"),ArdublocklyServer.putJson("/settings/ide",{new_value:"open"},o.setIdeHtml),o.shortMessage("Abrindo o Programa na IDE Arduino..."),o.sendCodeOpenCodeIDE()},o.sendCodeOpenCodeIDE=function(){o.largeIdeButtonSpinner(!0),o.ideStopButtonDesable(!0);ArdublocklyServer.sendSketchToServer(o.generateArduino(),(function(e){if(o.largeIdeButtonSpinner(!1),o.ideStopButtonDesable(!1),null===e)return o.openNotConnectedModal();var t=ArdublocklyServer.jsonToIdeModal(e);o.arduinoIdeOutput(t),o.changeIdeButtons("upload"),ArdublocklyServer.putJson("/settings/ide",{new_value:"upload"},o.setIdeHtml)}))}}]);